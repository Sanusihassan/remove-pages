---
import {
  tool,
  tools,
  errors,
  edit_page,
  downloadFile,
  adBlockerContent,
} from "../../content/content-es";
import { howToSchemas } from "../../how-to/how-to-es";
import BaseLayout from "../../partials/BaseLayout.astro";
import { configureStore } from "@reduxjs/toolkit";

export const routes = {
  "/pdf-to-powerpoint": { item: tool["PDF_to_Powerpoint"] },
  "/word-to-pdf": { item: tool["WORD_to_PDF"] },
  "/powerpoint-to-pdf": { item: tool["POWERPOINT_to_PDF"] },
  "/excel-to-pdf": { item: tool["EXCEL_to_PDF"] },
  "/html-to-pdf": { item: tool["HTML_to_PDF"] },
  "/pdf-to-word": { item: tool["PDF_to_WORD"] },
  "/pdf-to-excel": { item: tool["PDF_to_EXCEL"] },
  "/pdf-to-pdf-a": { item: tool["PDF_to_PDF_A"] },
  "/pdf-to-text": { item: tool["PDF_to_Text"] },
};

export const routesMap = {
  PDFtoPowerpointHOWTO: "/pdf-to-powerpoint",
  WordToPDFHOWTO: "/word-to-pdf",
  PowerpointToPDFHOWTO: "/powerpoint-to-pdf",
  ExcelToPDFHOWTO: "/excel-to-pdf",
  HTMLToPDFHOWTO: "/html-to-pdf",
  PDFtoWordHOWTO: "/pdf-to-word",
  PDFtoExcelHOWTO: "/pdf-to-excel",
  PDFtoPDFAHOWTO: "/pdf-to-pdf-a",
  PDFtoTextHOWTO: "/pdf-to-text",
};

export async function getStaticPaths() {
  const paths = Object.keys(routes).map((route) => {
    const toolSlug = route.substring(1); // Remove leading slash
    return {
      params: { tool: toolSlug },
      props: {
        item: routes[route].item as ToolType,
        currentRoute: route,
        toolSlug: toolSlug,
      },
    };
  });

  return paths;
}

// Get the props from getStaticPaths
const { item, currentRoute } = Astro.props;

// Construct the current path using the tool parameter
const asPath = `${currentRoute}`;

// Find matching how-to content
const matchingKey = Object.keys(routesMap).find(
  (key) => routesMap[key] === asPath
);

const currentHowTo = matchingKey ? howToSchemas[matchingKey] : null;

// Website schema for SEO
const websiteSchema = {
  "@context": "http://schema.org",
  "@type": "WebPage",
  name: `PDFEquips ${item.seoTitle}`,
  description: item.description,
  url: `https://www.pdfequips.com${asPath}`,
};

const lang = "es";
import toolReducer from "../../store";
import { ToolWrapper } from "../../../components/ToolWrapper";
import type { ToolType } from "../../content/content";
export const store = configureStore({
  reducer: {
    tool: toolReducer,
  },
});

const seoConfig = {
  title: item.seoTitle,
  description: item.description,
  to: item.to,
  openGraph: {
    url: item.to,
    title: item.seoTitle,
    description: item.description,
    images: [
      {
        url: `https://www.pdfequips.com/images/es${item.to}.png`,
        width: 1200,
        height: 630,
        alt: item.title,
        type: "image/png",
      },
    ],
    site_name: item.title,
    locale: "es_ES",
    type: "website",
  },
  twitter: {
    handle: "@pdfequips",
    site: "@pdfequips",
    cardType: "summary_large_image",
  },
};
---

<BaseLayout
  title={item.title}
  description={item.description}
  seoTitle={item.seoTitle}
  to={item.to}
  seoConfig={seoConfig}
>
  <Fragment slot="head">
    <script
      type="application/ld+json"
      is:inline
      set:html={JSON.stringify(websiteSchema)}
    />
    {
      currentHowTo && (
        <script
          type="application/ld+json"
          is:inline
          set:html={JSON.stringify(currentHowTo)}
        />
      )
    }
  </Fragment>
  <ToolWrapper
    client:load
    tools={tools}
    data={item}
    lang={lang}
    errors={errors}
    edit_page={edit_page}
    pages={edit_page.pages}
    page={edit_page.page}
    downloadFile={downloadFile}
    features={item.features}
    howTo={currentHowTo}
    seoTitle={item.title}
    to={currentRoute}
    adBlockerContent={adBlockerContent}
  />
</BaseLayout>
