---
import {
  tool,
  tools,
  errors,
  edit_page,
  downloadFile,
  adBlockerContent,
} from "../../content/content-ar";
import { LockPDFHOWTO_ar, UnlockPDFHOWTO_ar } from "../../how-to";
import BaseLayout from "../../partials/BaseLayout.astro";
import { configureStore } from "@reduxjs/toolkit";

export const routes = {
  "/lock-pdf": { item: tool["Lock_PDF"] },
  "/unlock-pdf": { item: tool["Unlock_PDF"] },
};

export async function getStaticPaths() {
  const paths = Object.keys(routes).map((route) => {
    const toolSlug = route.substring(1); // Remove leading slash
    return {
      params: { tool: toolSlug },
      props: {
        item: routes[route].item as ToolType,
        currentRoute: route,
        toolSlug: toolSlug,
      },
    };
  });

  return paths;
}

// Get the props from getStaticPaths
const { item, currentRoute } = Astro.props;

// Construct the current path using the tool parameter
const asPath = `${currentRoute}`;

const howToMap = {
  "/lock-pdf": LockPDFHOWTO_ar,
  "/unlock-pdf": UnlockPDFHOWTO_ar,
};

const currentHowTo = howToMap[asPath] ?? null;

// Website schema for SEO
const websiteSchema = {
  "@context": "http://schema.org",
  "@type": "WebPage",
  name: `PDFEquips ${item.seoTitle}`,
  description: item.description,
  url: `https://www.pdfequips.com${asPath}`,
};

const lang = "ar";
import toolReducer from "../../store";
import { ToolWrapper } from "../../../components/ToolWrapper";
import type { ToolType } from "../../content/content";
export const store = configureStore({
  reducer: {
    tool: toolReducer,
  },
});

const seoConfig = {
  title: item.seoTitle,
  description: item.description,
  to: item.to,
  openGraph: {
    url: item.to,
    title: item.seoTitle,
    description: item.description,
    images: [
      {
        url: `https://www.pdfequips.com/images/ar${item.to}.png`,
        width: 1200,
        height: 630,
        alt: item.title,
        type: "image/png",
      },
    ],
    site_name: item.title,
    locale: "ar_SA",
    type: "website",
  },
  twitter: {
    handle: "@pdfequips",
    site: "@pdfequips",
    cardType: "summary_large_image",
  },
};
---

<BaseLayout
  title={item.title}
  description={item.description}
  seoTitle={item.seoTitle}
  to={item.to}
  seoConfig={seoConfig}
>
  <Fragment slot="head">
    <script
      type="application/ld+json"
      is:inline
      set:html={JSON.stringify(websiteSchema)}
    />
    {
      currentHowTo && (
        <script
          type="application/ld+json"
          is:inline
          set:html={JSON.stringify(currentHowTo)}
        />
      )
    }
  </Fragment>
  <ToolWrapper
    client:load
    tools={tools}
    data={item}
    lang={lang}
    errors={errors}
    edit_page={edit_page}
    pages={edit_page.pages}
    page={edit_page.page}
    downloadFile={downloadFile}
    features={item.features}
    howTo={currentHowTo}
    seoTitle={item.title}
    to={currentRoute}
    adBlockerContent={adBlockerContent}
  />
</BaseLayout>
